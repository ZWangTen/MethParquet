% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/lm_ewas_outcome.R
\name{lm_ewas_outcome}
\alias{lm_ewas_outcome}
\title{Association analysis with linear regression}
\usage{
lm_ewas_outcome(
  db_obj,
  trait,
  select_sites = "full",
  select_chr = FALSE,
  gene_list = FALSE,
  gene_col = FALSE,
  covariates_string,
  parallel = FALSE,
  out_position = FALSE,
  NAs_to_zero = FALSE,
  block_size = 50000
)
}
\arguments{
\item{db_obj}{MethList created using \code{\link{create_methlist}}.}

\item{trait}{Exposure phenotype in `subject_annot` from `MethList`.}

\item{select_sites}{Character string consisting of CpG(s) to be tested. Default: `full` (all CpGs).
Only one selection for CpG is allowed, `sites`, `chromosome`, or `gene`.}

\item{select_chr}{Character string of chromosome number to select CpGs from. Default: `FALSE`.}

\item{gene_list}{Character string of gene names to select CpGs from. Default: `FALSE`.}

\item{gene_col}{Column for gene names in the CpG annotation data from `Methlist`.}

\item{covariates_string}{Columns for covariates to adjust in model from `subject_annot` of `MethList`.}

\item{parallel}{Number of cores used for parallel processing (forking). For details please see
\code{\link[future]{plan}}.  Default: FALSE (sequential processes).}

\item{out_position}{Column name for CpG position in chromosome from `cpg_annot` of `MethList`.
If given, output will contain these columns and chromosome number.}

\item{NAs_to_zero}{Convert missing values to 0 in methylation data. Default: `FALSE`.}

\item{block_size}{Integer to specify number of CpGs in each iteration block. Default: 50,000.}
}
\value{
A data frame with coefficient estimates for `trait` and testing statistics.
}
\description{
lm_ewas_outcome performs association analysis with linear regression
using methylation as the outcome.
}
\examples{
library(tidyverse)
library(arrow)
data(phenoData)
data(chrAnnotation)
data(MethData)
wdir <- getwd()
path <- paste0(wdir,'/Parquet_Directory')

# Create Parquet data in 'path' and MethList
MethData \%>\% group_by(CHR) \%>\% arrow::write_dataset(path,format = "parquet")

mlist <- create_methlist(db_path = path,cpg_col_db='CpG',subject_annot = phenoData,
subject_col_keep='all',cpgAnnot_col_keep=c(1:2,12:13,16),cpg_annot = chrAnnotation,
subject_id='sample_id',cpg_col_annot='Name', gene_col_name = 'UCSC_RefGene_Name')

# Run linear regression model
ewas_lm <- lm_ewas_outcome(db_obj=mlist,trait='bmi',select_sites='full',select_chr=FALSE,
covariates_string = c('age','sex'),out_position='MAPINFO',block_size=100000)
head(ewas_lm)
unlink(path,recursive=TRUE)
}
